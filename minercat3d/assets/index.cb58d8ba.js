var yt=Object.defineProperty;var xt=(e,t,o)=>t in e?yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var _e=(e,t,o)=>(xt(e,typeof t!="symbol"?t+"":t,o),o);const vt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function o(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=o(i);fetch(i.href,r)}};vt();var je=1e-6,te=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function Qe(){var e=new te(16);return te!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function mt(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _t(e,t,o,n,i){var r=1/Math.tan(t/2),s;return e[0]=r/o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(s=1/(n-i),e[10]=(i+n)*s,e[14]=2*i*n*s):(e[10]=-1,e[14]=-2*n),e}var At=_t;function Et(e,t,o,n){var i,r,s,c,l,p,k,f,v,a,x=t[0],m=t[1],g=t[2],P=n[0],_=n[1],B=n[2],w=o[0],h=o[1],u=o[2];return Math.abs(x-w)<je&&Math.abs(m-h)<je&&Math.abs(g-u)<je?mt(e):(k=x-w,f=m-h,v=g-u,a=1/Math.hypot(k,f,v),k*=a,f*=a,v*=a,i=_*v-B*f,r=B*k-P*v,s=P*f-_*k,a=Math.hypot(i,r,s),a?(a=1/a,i*=a,r*=a,s*=a):(i=0,r=0,s=0),c=f*s-v*r,l=v*i-k*s,p=k*r-f*i,a=Math.hypot(c,l,p),a?(a=1/a,c*=a,l*=a,p*=a):(c=0,l=0,p=0),e[0]=i,e[1]=c,e[2]=k,e[3]=0,e[4]=r,e[5]=l,e[6]=f,e[7]=0,e[8]=s,e[9]=p,e[10]=v,e[11]=0,e[12]=-(i*x+r*m+s*g),e[13]=-(c*x+l*m+p*g),e[14]=-(k*x+f*m+v*g),e[15]=1,e)}function O(){var e=new te(3);return te!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function M(e,t,o){var n=new te(3);return n[0]=e,n[1]=t,n[2]=o,n}function Ee(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function nt(e,t,o){return e[0]=t[0]+o[0],e[1]=t[1]+o[1],e[2]=t[2]+o[2],e}function gt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function rt(e,t,o){return e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function Z(e,t,o,n){return e[0]=t[0]+o[0]*n,e[1]=t[1]+o[1]*n,e[2]=t[2]+o[2]*n,e}function it(e,t){var o=t[0],n=t[1],i=t[2],r=o*o+n*n+i*i;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function Bt(e,t,o){var n=t[0],i=t[1],r=t[2],s=o[0],c=o[1],l=o[2];return e[0]=i*l-r*c,e[1]=r*s-n*l,e[2]=n*c-i*s,e}function wt(e){return e[0]=0,e[1]=0,e[2]=0,e}(function(){var e=O();return function(t,o,n,i,r,s){var c,l;for(o||(o=3),n||(n=0),i?l=Math.min(i*o+n,t.length):l=t.length,c=n;c<l;c+=o)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],r(e,e,s),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}})();function ct(){var e=new te(2);return te!=Float32Array&&(e[0]=0,e[1]=0),e}function Rt(e,t,o){return e[0]=t[0]*o,e[1]=t[1]*o,e}function St(e){return e[0]=0,e[1]=0,e}(function(){var e=ct();return function(t,o,n,i,r,s){var c,l;for(o||(o=2),n||(n=0),i?l=Math.min(i*o+n,t.length):l=t.length,c=n;c<l;c+=o)e[0]=t[c],e[1]=t[c+1],r(e,e,s),t[c]=e[0],t[c+1]=e[1];return t}})();const st=41,Xe=[0,.5,.5,1,1.25,1.5,1.75,2,5,6,7,8,25,30,35,40,125,150,175,200,600,750,850,950,4e3,4500,5e3,5500,2e4,21e3,22e3,23e3,8e4,85e3,9e4,95e3,32e4,33e4,34e4,35e4,0,0].map(e=>e*90),Ke=[1,3,7,20,60,175,450,2500,7500,2e4,8e4,35e4,15e5,5e6].map(e=>e*90),Ct=[0,100,1500,5e3,3e4,125e3,35e4,15e5,75e5,45e6,25e7,1e9,1e10,1e11],Mt=["Wood Pickaxe","Stone Pickaxe","Copper Pickaxe","Iron Pickaxe","Platinum Pickaxe","Gold Pickaxe","Diamond Pickaxe","Emerald Pickaxe","Ruby Pickaxe","Master Pickaxe","Obsidian Pickaxe","Sapphire Pickaxe","Hellstone Pickaxe","Fire Pickaxe"],Je=[10,20,35,50,75,125,200,450],Tt=[0,450,5e3,16e3,1e5,75e4,5e6,45e6],Pt=["Hands","Cola Can","Water Bottle","Pringles Can","Plastic Bag","School Backpack","Normal Backpack","Miner Backpack"],Ft=[100,120,140,200,350,650,1e3,7500],Lt=["nothing","Copper Armor","Iron Armor","Gold Armor","Diamond Armor","Emerald Armor","Sapphire Armor","Hellstone Armor"],It=[0,1e4,2e5,25e5,2e7,1e8,1e9,25e9],lt=[0,1,2,4,10,20,25,30,10,150,175,250,75,1250,1500,1750,1e3,1e4,12500,15e3,7500,75e3,9e4,1e5,75e3,75e4,875e3,1e6,75e4,75e5,875e4,1e7,75e5,75e6,875e5,1e8,75e6,75e7,875e6,1e9],at=new Map;function U(e,t){at.set(e,JSON.stringify(t))}const dt=document.getElementById("debug");function ft(){let e="";for(const[t,o]of at)e+=`${t}: ${o}
`;dt.textContent=e,requestAnimationFrame(ft)}window.addEventListener("keydown",e=>{e.code=="F3"&&dt.classList.toggle("visible"),e.preventDefault()});requestAnimationFrame(ft);let N=Object.create(null),ut=Object.create(null);window.onkeydown=e=>{N[e.code]||(ut[e.code]=!0),N[e.code]=!0};window.onkeyup=e=>N[e.code]=!1;let Ze=Object.create(null),ht=Object.create(null);window.onmousedown=e=>{ht[e.button]=!0,Ze[e.button]=!0};window.onmouseup=e=>{Ze[e.button]=!1};let q=ct();window.addEventListener("mousemove",e=>{Ae||!document.pointerLockElement||(e.movementX!==-2&&(q[0]+=e.movementX),q[1]+=e.movementY)});const H=1.75,J=0,E=.1875,Ut=document.getElementById("backpack"),Ge=document.getElementById("shop"),jt=document.getElementById("sellall"),Nt=document.getElementById("layer"),Ot=document.getElementById("cash"),qt=document.getElementById("hp"),Ne=document.getElementById("shopinfoname"),Oe=document.getElementById("shopinfonumber"),De=document.getElementById("shopmenu"),me=document.getElementById("shoptabs"),qe=document.getElementById("shopicon"),He=document.getElementById("shopprice");let Ve=!1;jt.addEventListener("click",()=>{document.getElementById("canvas").requestPointerLock(),Ve=!0});let $e=!1;Ge.addEventListener("click",()=>{Ae&&document.getElementById("canvas").requestPointerLock(),$e=!0});let ve=null;for(let e=0;e<me.children.length;e++)me.children[e].addEventListener("click",()=>{ve=e});let Ae=!1;function Ht(e,t){var n,i;Ae=e.shop.open,Ae||Yt(e,t),zt(e),Nt.textContent=(e.position[1]-H).toFixed(),Ot.textContent=Gt(e.cash)+"$",qt.textContent="hp:"+e.hp.toString(),Ut.textContent=`${e.backpackContents.length}/${Je[e.backpack]}`,U("position",e.position),U("facing",e.facing),U("pitch",e.pitch),U("yaw",e.yaw),U("highlighted position",e.highlighted);const o=e.blocks.getBlock((n=e.highlighted)!=null?n:[0,0,0]);U("highlighted block id",o),U("highlighted block health",e.blocks.getBlockHealth((i=e.highlighted)!=null?i:[0,0,0])),U("highlighted block max health",Xe[o]),U("highlighted block cash",lt[o]),U("velocity",e.velocity),U("isOnGround",e.isOnGround),U("pickaxe",e.pickaxe),U("pickaxe speed",Ke[e.pickaxe]),U("backpack",e.backpackContents),U("feetpos",e.position[1]-H),ut=Object.create(null),ht=Object.create(null)}function Yt(e,t){$t(t,e),e.velocity[1]-=16*t,e.velocity[1]<-30&&(e.velocity[1]=-30),Xt(t,e),Kt(e,t),Ze[0]&&e.highlighted&&e.blocks.damage(e.highlighted,Ke[e.pickaxe]*t),e.highlighted=Vt(e)}function zt(e){if(Ve){wt(e.velocity),Ee(e.position,bt);for(const t of e.backpackContents)e.cash+=lt[t];e.backpackContents.length=0,Ve=!1}if($e&&(e.shop.open?(e.shop.open=!1,Ge.textContent="shop",De.classList.remove("visible")):(et(e.shop.tab,e),e.shop.open=!0,Ge.textContent="back",De.classList.add("visible")),$e=!1),ve!==null){for(let t=0;t<me.children.length;t++)t==ve?me.children[t].classList.add("selected"):me.children[t].classList.remove("selected");e.shop.tab=ve,et(e.shop.tab,e),ve=null}}function et(e,t){e===0?(qe.src=`/minercat3d/pickaxe/pickaxe${t.pickaxe+2}.png`,He.textContent=Ct[t.pickaxe+1]+"$",Ne.textContent=Mt[t.pickaxe+1].toLowerCase(),Oe.textContent="speed: "+Ke[t.pickaxe+1]):e===1?(qe.src=`/minercat3d/backpack/backpack${t.backpack+2}.png`,He.textContent=Tt[t.backpack+1]+"$",Ne.textContent=Pt[t.backpack+1].toLowerCase(),Oe.textContent="space: "+Je[t.backpack+1]):e===2&&(qe.src=`/minercat3d/armor/armor${t.armor+2}.png`,He.textContent=It[t.armor+1]+"$",Ne.textContent=Lt[t.armor+1].toLowerCase(),Oe.textContent="health: "+Ft[t.armor+1])}function Gt(e){return e.toFixed()}function Vt(e){const o=O(),n=O();let i=0;for(;i<5;){if(Z(o,e.position,e.facing,i),pt(n,o),e.blocks.getBlock(n))return n;i+=.01}return null}function $t(e,t){let o=5;N.ArrowRight&&(q[0]+=o),N.ArrowLeft&&(q[0]-=o),N.ArrowUp&&(q[1]-=o),N.ArrowDown&&(q[1]+=o),Rt(q,q,.15),t.yaw+=q[0],t.pitch-=q[1],t.pitch>89&&(t.pitch=89),t.pitch<-89&&(t.pitch=-89),Wt(t),St(q)}function Wt(e){const t=O(),o=n=>n/180*Math.PI;t[0]=Math.cos(o(e.yaw))*Math.cos(o(e.pitch)),t[1]=Math.sin(o(e.pitch)),t[2]=Math.sin(o(e.yaw))*Math.cos(o(e.pitch)),it(e.facing,t)}function Xt(e,t){const n=Ee(O(),t.facing);n[1]=0,it(n,n);const i=Bt(O(),n,[0,1,0]);t.velocity[0]=0,t.velocity[2]=0,N.KeyW&&Z(t.velocity,t.velocity,n,8),N.KeyS&&Z(t.velocity,t.velocity,n,-8),N.Space&&t.isOnGround&&(t.velocity[1]=9),N.ShiftLeft,N.KeyA&&Z(t.velocity,t.velocity,i,-8),N.KeyD&&Z(t.velocity,t.velocity,i,8)}function pt(e,t){return Ee(e,t),gt(e,e),e[1]*=-1,e}function Kt(e,t){const o=rt(O(),e.velocity,t);Ye(e,M(o[0],0,0))&&(e.velocity[0]=0),Ye(e,M(0,o[1],0))?(e.velocity[1]=0,o[1]<=0&&(e.isOnGround=!0)):e.isOnGround=!1,Ye(e,M(0,0,o[2]))&&(e.velocity[2]=0)}function Ye(e,t){for(let n=0;n<10;n++)if(Z(e.position,e.position,t,1/10),Zt(e))return Z(e.position,e.position,t,-1/10),!0;return!1}const Jt=[M(-E,-H,-E),M(-E,-H,E),M(E,-H,-E),M(E,-H,E),M(-E,J,-E),M(-E,J,E),M(E,J,-E),M(E,J,E),M(-E,(J-H)/2,-E),M(-E,(J-H)/2,E),M(E,(J-H)/2,-E),M(E,(J-H)/2,E)];function Zt(e){const t=O(),o=O();for(const n of Jt)if(nt(o,e.position,n),pt(t,o),e.blocks.getBlock(t))return!0;return!1}const Qt=.5*(Math.sqrt(3)-1),xe=(3-Math.sqrt(3))/6,Dt=1/3,z=1/6,eo=(Math.sqrt(5)-1)/4,j=(5-Math.sqrt(5))/20,I=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),C=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);class to{constructor(t=Math.random){const o=typeof t=="function"?t:ro(t);this.p=no(o),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let n=0;n<512;n++)this.perm[n]=this.p[n&255],this.permMod12[n]=this.perm[n]%12}noise2D(t,o){const n=this.permMod12,i=this.perm;let r=0,s=0,c=0;const l=(t+o)*Qt,p=Math.floor(t+l),k=Math.floor(o+l),f=(p+k)*xe,v=p-f,a=k-f,x=t-v,m=o-a;let g,P;x>m?(g=1,P=0):(g=0,P=1);const _=x-g+xe,B=m-P+xe,w=x-1+2*xe,h=m-1+2*xe,u=p&255,b=k&255;let y=.5-x*x-m*m;if(y>=0){const F=n[u+i[b]]*3;y*=y,r=y*y*(I[F]*x+I[F+1]*m)}let R=.5-_*_-B*B;if(R>=0){const F=n[u+g+i[b+P]]*3;R*=R,s=R*R*(I[F]*_+I[F+1]*B)}let S=.5-w*w-h*h;if(S>=0){const F=n[u+1+i[b+1]]*3;S*=S,c=S*S*(I[F]*w+I[F+1]*h)}return 70*(r+s+c)}noise3D(t,o,n){const i=this.permMod12,r=this.perm;let s,c,l,p;const k=(t+o+n)*Dt,f=Math.floor(t+k),v=Math.floor(o+k),a=Math.floor(n+k),x=(f+v+a)*z,m=f-x,g=v-x,P=a-x,_=t-m,B=o-g,w=n-P;let h,u,b,y,R,S;_>=B?B>=w?(h=1,u=0,b=0,y=1,R=1,S=0):_>=w?(h=1,u=0,b=0,y=1,R=0,S=1):(h=0,u=0,b=1,y=1,R=0,S=1):B<w?(h=0,u=0,b=1,y=0,R=1,S=1):_<w?(h=0,u=1,b=0,y=0,R=1,S=1):(h=0,u=1,b=0,y=1,R=1,S=0);const F=_-h+z,Y=B-u+z,oe=w-b+z,ne=_-y+2*z,re=B-R+2*z,ie=w-S+2*z,ce=_-1+3*z,se=B-1+3*z,le=w-1+3*z,Q=f&255,D=v&255,ee=a&255;let X=.6-_*_-B*B-w*w;if(X<0)s=0;else{const L=i[Q+r[D+r[ee]]]*3;X*=X,s=X*X*(I[L]*_+I[L+1]*B+I[L+2]*w)}let K=.6-F*F-Y*Y-oe*oe;if(K<0)c=0;else{const L=i[Q+h+r[D+u+r[ee+b]]]*3;K*=K,c=K*K*(I[L]*F+I[L+1]*Y+I[L+2]*oe)}let $=.6-ne*ne-re*re-ie*ie;if($<0)l=0;else{const L=i[Q+y+r[D+R+r[ee+S]]]*3;$*=$,l=$*$*(I[L]*ne+I[L+1]*re+I[L+2]*ie)}let W=.6-ce*ce-se*se-le*le;if(W<0)p=0;else{const L=i[Q+1+r[D+1+r[ee+1]]]*3;W*=W,p=W*W*(I[L]*ce+I[L+1]*se+I[L+2]*le)}return 32*(s+c+l+p)}noise4D(t,o,n,i){const r=this.perm;let s,c,l,p,k;const f=(t+o+n+i)*eo,v=Math.floor(t+f),a=Math.floor(o+f),x=Math.floor(n+f),m=Math.floor(i+f),g=(v+a+x+m)*j,P=v-g,_=a-g,B=x-g,w=m-g,h=t-P,u=o-_,b=n-B,y=i-w;let R=0,S=0,F=0,Y=0;h>u?R++:S++,h>b?R++:F++,h>y?R++:Y++,u>b?S++:F++,u>y?S++:Y++,b>y?F++:Y++;const oe=R>=3?1:0,ne=S>=3?1:0,re=F>=3?1:0,ie=Y>=3?1:0,ce=R>=2?1:0,se=S>=2?1:0,le=F>=2?1:0,Q=Y>=2?1:0,D=R>=1?1:0,ee=S>=1?1:0,X=F>=1?1:0,K=Y>=1?1:0,$=h-oe+j,W=u-ne+j,L=b-re+j,ge=y-ie+j,Be=h-ce+2*j,we=u-se+2*j,Re=b-le+2*j,Se=y-Q+2*j,Ce=h-D+3*j,Me=u-ee+3*j,Te=b-X+3*j,Pe=y-K+3*j,Fe=h-1+4*j,Le=u-1+4*j,Ie=b-1+4*j,Ue=y-1+4*j,ae=v&255,de=a&255,fe=x&255,ue=m&255;let he=.6-h*h-u*u-b*b-y*y;if(he<0)s=0;else{const A=r[ae+r[de+r[fe+r[ue]]]]%32*4;he*=he,s=he*he*(C[A]*h+C[A+1]*u+C[A+2]*b+C[A+3]*y)}let pe=.6-$*$-W*W-L*L-ge*ge;if(pe<0)c=0;else{const A=r[ae+oe+r[de+ne+r[fe+re+r[ue+ie]]]]%32*4;pe*=pe,c=pe*pe*(C[A]*$+C[A+1]*W+C[A+2]*L+C[A+3]*ge)}let ke=.6-Be*Be-we*we-Re*Re-Se*Se;if(ke<0)l=0;else{const A=r[ae+ce+r[de+se+r[fe+le+r[ue+Q]]]]%32*4;ke*=ke,l=ke*ke*(C[A]*Be+C[A+1]*we+C[A+2]*Re+C[A+3]*Se)}let be=.6-Ce*Ce-Me*Me-Te*Te-Pe*Pe;if(be<0)p=0;else{const A=r[ae+D+r[de+ee+r[fe+X+r[ue+K]]]]%32*4;be*=be,p=be*be*(C[A]*Ce+C[A+1]*Me+C[A+2]*Te+C[A+3]*Pe)}let ye=.6-Fe*Fe-Le*Le-Ie*Ie-Ue*Ue;if(ye<0)k=0;else{const A=r[ae+1+r[de+1+r[fe+1+r[ue+1]]]]%32*4;ye*=ye,k=ye*ye*(C[A]*Fe+C[A+1]*Le+C[A+2]*Ie+C[A+3]*Ue)}return 27*(s+c+l+p+k)}}var oo=to;function no(e){const t=new Uint8Array(256);for(let o=0;o<256;o++)t[o]=o;for(let o=0;o<255;o++){const n=o+~~(e()*(256-o)),i=t[o];t[o]=t[n],t[n]=i}return t}function ro(e){let t=0,o=0,n=0,i=1;const r=io();return t=r(" "),o=r(" "),n=r(" "),t-=r(e),t<0&&(t+=1),o-=r(e),o<0&&(o+=1),n-=r(e),n<0&&(n+=1),function(){const s=2091639*t+i*23283064365386963e-26;return t=o,o=n,n=s-(i=s|0)}}function io(){let e=4022871197;return function(t){t=t.toString();for(let o=0;o<t.length;o++){e+=t.charCodeAt(o);let n=.02519603282416938*e;e=n>>>0,n-=e,n*=e,e=n>>>0,n-=e,e+=n*4294967296}return(e>>>0)*23283064365386963e-26}}const ze=[{y:5,tries:[{do:0}]},{y:6,tries:[{do:{type:"firstlayer"}}]},{y:7,tries:[{do:2}]},{y:24,tries:[{chance:10,do:4},{chance:12,do:5},{chance:14,do:6},{chance:16,do:7},{do:3}]},{y:60,tries:[{chance:10,do:9},{chance:12,do:10},{chance:14,do:11},{do:8}]},{y:110,tries:[{chance:10,do:13},{chance:12,do:14},{chance:14,do:15},{do:12}]},{y:160,tries:[{chance:10,do:17},{chance:12,do:18},{chance:14,do:19},{do:16}]},{y:225,tries:[{chance:10,do:21},{chance:12,do:22},{chance:14,do:23},{do:20}]},{y:300,tries:[{chance:10,do:25},{chance:12,do:26},{chance:14,do:27},{do:24}]},{y:375,tries:[{chance:10,do:29},{chance:12,do:30},{chance:14,do:31},{do:28}]},{y:500,tries:[{chance:10,do:33},{chance:12,do:34},{chance:14,do:35},{do:32}]},{y:8250,tries:[{chance:10,do:37},{chance:12,do:38},{chance:14,do:39},{do:36}]}];function co(e){so(e),ao(e);for(let t=0;t<V;t++)for(let o=0;o<d;o++)for(let n=0;n<d;n++)e.setBlockHealth([o,t,n],Xe[e.getBlock([o,t,n])])}function so(e){let t=0;for(let o=0;o<V&&(o>ze[t].y&&t++,!(t>=ze.length));o++)for(let n=0;n<d;n++)for(let i=0;i<d;i++)for(const r of ze[t].tries)if(!("chance"in r&&Math.random()>=1/r.chance)){if(typeof r.do=="number")e.setBlock([n,o,i],r.do);else if(r.do.type=="firstlayer"){const s=Math.floor(d/2);(n==s||n==s-1)&&(i==s||i==s-1)?e.setBlock([n,o,i],st):e.setBlock([n,o,i],1)}break}}let lo=new oo;function ao(e){for(let t=0;t<V;t++)for(let o=0;o<d;o++)for(let n=0;n<d;n++){let i=Math.max(0,Math.min(1,(t-5)/5));i*=Math.min(8,Math.min(o,d-o))/8,i*=Math.min(8,Math.min(n,d-n))/8;const r=.08,s=.35;lo.noise3D(o*r,t*r,n*r)*i>s&&e.setBlock([o,t,n],0)}}var fo="/minercat3d/assets/blocks.ef3cb20d.png";document.getElementById("enterfullscreen").onclick=kt;function kt(){document.querySelector(".guiPlayer").classList.add("fullscreen"),document.querySelector(".stage-wrapper_stage-wrapper_2bejr").classList.add("stage-wrapper_full-screen_2hjMb"),document.querySelector(".stage-wrapper_stage-wrapper_2bejr > .box_box_2jjDp").innerHTML=`
    <div class="stage-header_stage-header-wrapper-overlay_5vfJa box_box_2jjDp">
      <div class="stage-header_stage-menu-wrapper_15JJt box_box_2jjDp" style="width: 960px;">
        <div class="controls_controls-container_2xinB"><img class="green-flag_green-flag_1kiAo"
          draggable="false" src="/greenflag.svg" title="Go"><img class="stop-all_stop-all_1Y8P9"
          draggable="false" src="/stop.svg" title="Stop"></div><span
        class="button_outlined-button_1bS__ stage-header_stage-button_hkl9B" role="button">
        <div class="button_content_3jdgj"><img id="closefullscreen" alt="Exit full screen mode"
            class="stage-header_stage-button-icon_3zzFK" draggable="false" src="/closefullscreen.svg"
            title="Full Screen Control">
        </div>
      </span>
    </div>
  `,document.querySelector(".stage_stage_1fD7k").style.width="960px",document.querySelector(".stage_stage_1fD7k").style.height="720px",document.getElementById("canvas").style.width="960px",document.getElementById("canvas").style.height="720px",document.querySelector(".stage_stage-bottom-wrapper_KIBfo").style.width="960",document.querySelector(".stage_stage-bottom-wrapper_KIBfo").style.height="720",document.querySelector(".stage_stage-overlays_eE14L").classList.add("stage_full-screen_ZO7xi"),document.getElementById("closefullscreen").onclick=uo}function uo(){document.querySelector(".guiPlayer").classList.remove("fullscreen"),document.querySelector(".stage-wrapper_stage-wrapper_2bejr").classList.remove("stage-wrapper_full-screen_2hjMb"),document.querySelector(".stage-wrapper_stage-wrapper_2bejr > .box_box_2jjDp").innerHTML=`
  <div class="stage-header_stage-header-wrapper_1F4gT box_box_2jjDp">
    <div class="stage-header_stage-menu-wrapper_15JJt box_box_2jjDp"
      style="padding-bottom: 0px; padding-top: 0px;">
      <!-- I don't know why but I had to add these width: 20px; height: 20px or else it to big -->
      <div class="controls_controls-container_2xinB"><img id="greenflag"
          class="green-flag_green-flag_1kiAo" draggable="false" src="/greenflag.svg" title="Go"
          ><img class="stop-all_stop-all_1Y8P9" draggable="false"
           src="/stop.svg" title="Stop" id="stop"></div>
      <div class="stage-header_stage-size-row_14N65">
        <div><span class="button_outlined-button_1bS__ stage-header_stage-button_hkl9B"
             id="enterfullscreen" role="button">
            <div class="button_content_3jdgj"><img alt="Enter full screen mode"
                class="stage-header_stage-button-icon_3zzFK" draggable="false"
                src="/fullscreen.svg" title="Full Screen Control">
            </div>
          </span></div>
      </div>
    </div>
  `,document.querySelector(".stage_stage_1fD7k").style.width="480px",document.querySelector(".stage_stage_1fD7k").style.height="360px",document.getElementById("canvas").style.width="480px",document.getElementById("canvas").style.height="360px",document.querySelector(".stage_stage-bottom-wrapper_KIBfo").style.width="480",document.querySelector(".stage_stage-bottom-wrapper_KIBfo").style.height="360",document.querySelector(".stage_stage-overlays_eE14L").classList.remove("stage_full-screen_ZO7xi"),document.getElementById("enterfullscreen").onclick=kt}const d=24,V=8250,We=d*d,bt=M(d/2,-5+H+.2,d/2);function G(e){throw alert(e),new Error(e)}class ho{constructor(){_e(this,"array");_e(this,"gl",null);_e(this,"buffer",null);this.array=new Uint32Array(We*V),co(this)}getBlock([t,o,n]){return t<0||t>=d||n<0||n>=d||o<0||o>=V?0:this.array[t+d*(n+d*o)]&63}setBlock([t,o,n],i){var s,c;if(t<0||t>=d||n<0||n>=d||o<0||o>=V)return;const r=t+d*(n+d*o);this.array[r]=(this.array[r]&-64)+i,(s=this.gl)==null||s.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),(c=this.gl)==null||c.bufferSubData(this.gl.ARRAY_BUFFER,r*4,this.array,r,4)}getBlockHealth([t,o,n]){return t<0||t>=d||n<0||n>=d||o<0||o>=V?0:this.array[t+d*(n+d*o)]>>6}setBlockHealth([t,o,n],i){var s,c;if(t<0||t>=d||n<0||n>=d||o<0||o>=V)return;const r=t+d*(n+d*o);this.array[r]=(this.array[r]&63)+(i<<6),(s=this.gl)==null||s.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),(c=this.gl)==null||c.bufferSubData(this.gl.ARRAY_BUFFER,r*4,this.array,r,4)}damage(t,o){const n=T.blocks.getBlock(t);if(n===st)return;const i=T.blocks.getBlockHealth(t)-o;i<=0?(T.blocks.setBlock(t,0),T.backpackContents.length<Je[T.backpack]&&T.backpackContents.push(n)):T.blocks.setBlockHealth(t,i)}}let T={position:Ee(O(),bt),facing:M(0,0,0),cameraUp:M(0,1,0),pitch:0,yaw:0,highlighted:null,blocks:new ho,velocity:O(),isOnGround:!1,pickaxe:0,backpack:0,backpackContents:[],cash:0,hp:0,armor:0,shop:{open:!1,tab:0}};function po(e,t){const o=t=="uint"?"u":"";let n=t+"[](",i="";for(const r of e)n+=i+r.toFixed()+o,i=", ";return n+=")",n}function ko(){var a,x,m,g,P;const e=document.querySelector("#canvas");e.addEventListener("click",()=>{T.shop.open||e.requestPointerLock()});const t=e.getContext("webgl2");t||G("Unable to initialize WebGL2");const o=`#version 300 es

    // vertex attributes
    in vec4 aVertexPosition;
    in vec2 aTextureCoord;
  
    // instance attributes
    in uint iBlock;
  
    out highp vec2 vTextureCoord;
    out highp vec2 vBreakingCoord;
    out float isAir;
    out float isHighlighted;
  
    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;
    uniform int layerStart;
    uniform vec3 highlighted; // index in array of highlighted block
  
    
    void main() {
      const uint[] blockTypeHealth = ${po(Xe,"uint")};

      int x = gl_InstanceID % ${d};
      int zy = gl_InstanceID / ${d};
      int z = zy % ${d};
      int y = zy / ${d};
      
      vec3 blockPosition = vec3(x, -y-layerStart, z);
      vec3 highlightedPosition = vec3(highlighted.x, -highlighted.y, highlighted.z);
  
  
      uint blockId = iBlock & 63u;
      uint blockHealth = iBlock >> 6u;
      uint textureNum;
  

      isAir = 0.0;
  
      gl_Position = uProjectionMatrix * uModelViewMatrix * (aVertexPosition + vec4(blockPosition, 0.0));
  
      if (blockId == 0u) { // air
        isAir = 1.0;
      } else if (blockId == 1u) { // grass
        if (gl_VertexID >= 8 && gl_VertexID < 12) {
          // top
          textureNum = 0u;
        } else if (gl_VertexID >= 12 && gl_VertexID < 16) {
          // bottom
          textureNum = 2u;
        } else {
          textureNum = 1u;
        }
      } else {
        textureNum = blockId;
      }
  
      isHighlighted = blockPosition == highlightedPosition ? 1.0 : 0.0;
  
      vTextureCoord = (aTextureCoord + vec2(textureNum, 0.0)) / vec2(42.0, 2.0);
      
      float breakingProgress = 1.0 - (float(blockHealth) / float(blockTypeHealth[blockId]));
      uint breakingNum = uint(breakingProgress * 11.0);
      vBreakingCoord = (aTextureCoord + vec2(breakingNum, 1.0)) / vec2(42.0, 2.0);
    }
  `,i=tt(t,o,`#version 300 es
    precision mediump float;
    precision lowp sampler3D;    out vec4 fragColor;
  
    in highp vec2 vTextureCoord;
    in highp vec2 vBreakingCoord;
    in float isAir;
    in float isHighlighted;

    uniform sampler2D uSampler;
    
    void main() {
      if (isAir > 0.5) { discard; }
      
      if(texture(uSampler, vBreakingCoord).a != 0.0) {
        fragColor = vec4(0.0, 0.0, 0.0, 1.0);
      } else {
        fragColor = texture(uSampler, vTextureCoord);
      }
      
 
      if (isHighlighted > 0.5) {
        vec2 uv = fract(vTextureCoord * vec2(42.0, 2.0));
        float pickerWidth =  1.0 / 16.0;
        if (uv.x < pickerWidth || uv.x > 1. - pickerWidth || uv.y < pickerWidth || uv.y > 1. - pickerWidth) {
          fragColor = vec4(1.0);
        }
      }
      
      // fragColor = vec4(vTextureCoord * vec2(42.0, 1.0), 0.0, 1.0);
    }
  `),c=tt(t,`#version 300 es
    precision mediump float;
    in vec4 vertexPosition;
    in vec2 textureCoord;
  
    void main() {
      gl_Position = vertexPosition;
    }
  `,`#version 300 es
    precision mediump float;
    out vec4 fragColor;
  
    void main() {
      fragColor = vec4(1.0, 0.0, 1.0, 1.0);
    }
  `),l={blocks:{program:i,attribLocations:{vertexPosition:t.getAttribLocation(i,"aVertexPosition"),textureCoord:t.getAttribLocation(i,"aTextureCoord"),block:t.getAttribLocation(i,"iBlock")},uniformLocations:{projectionMatrix:(a=t.getUniformLocation(i,"uProjectionMatrix"))!=null?a:G("couldn't find uniform uProjectionMatrix"),modelViewMatrix:(x=t.getUniformLocation(i,"uModelViewMatrix"))!=null?x:G("couldn't find uniform uModelViewMatrix"),sampler:(m=t.getUniformLocation(i,"uSampler"))!=null?m:G("couldn't find uniform uSampler"),layerStart:(g=t.getUniformLocation(i,"layerStart"))!=null?g:G("couldn't find uniform layerStart"),highlighted:(P=t.getUniformLocation(i,"highlighted"))!=null?P:G("couldn't find uniform highlighted")}},pickaxe:{program:c,attribLocations:{vertexPosition:t.getAttribLocation(c,"vertexPosition"),textureCoord:t.getAttribLocation(c,"textureCoord")}}},p=yo(t),k=bo(t,fo);let f=0;function v(_){_*=.001;const B=_-f;f=_,Ht(T,B),xo(t,k,l,p),requestAnimationFrame(v)}requestAnimationFrame(v)}function tt(e,t,o){const n=ot(e,e.VERTEX_SHADER,t),i=ot(e,e.FRAGMENT_SHADER,o),r=e.createProgram();return r||G("error creating shader program"),e.attachShader(r,n),e.attachShader(r,i),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS)||G(`error linking shader program: ${e.getProgramInfoLog(r)}`),r}function ot(e,t,o){const n=e.createShader(t);if(n||G("error creating shader"),e.shaderSource(n,o),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){const i=e.getShaderInfoLog(n);e.deleteShader(n),G(`error compiling shader: ${i}`)}return n}function bo(e,t){const o=e.createTexture();e.bindTexture(e.TEXTURE_2D,o);const n=0,i=e.RGBA,r=1,s=1,c=0,l=e.RGBA,p=e.UNSIGNED_BYTE,k=new Uint8Array([0,0,255,255]);e.texImage2D(e.TEXTURE_2D,n,i,r,s,c,l,p,k);const f=new Image;return f.onload=function(){e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,n,i,l,p,f),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)},f.src=t,o}function yo(e){const t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t);const o=[0,0,1,1,0,1,1,1,1,0,1,1,0,0,0,0,1,0,1,1,0,1,0,0,0,1,0,0,1,1,1,1,1,1,1,0,0,0,0,1,0,0,1,0,1,0,0,1,1,0,0,1,1,0,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,0];e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW);const n=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n);const i=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),e.STATIC_DRAW);const r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r);const s=[0,1,1,1,1,0,0,0,1,1,1,0,0,0,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,1,1,1,0,0,0,0,1,0,1,1,1,1,0,0,0];e.bufferData(e.ARRAY_BUFFER,new Float32Array(s),e.STATIC_DRAW);const c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,T.blocks.array,e.DYNAMIC_DRAW);const l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,0,0,0,1,0]),e.STATIC_DRAW);const p=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,p),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1]),e.STATIC_DRAW),T.blocks.buffer=c,T.blocks.gl=e,{blocks:{vertexPosition:t,indices:n,textureCoord:r},pickaxe:{vertexPosition:l,textureCoord:p}}}function xo(e,t,o,n){var B;const i=M(.4,1,.996),r=M(0,.192,.188),s=Math.max(0,Math.min(1,-T.position[1]/10)),c=O();rt(c,i,1-s),Z(c,c,r,s),e.clearColor(c[0],c[1],c[2],1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const l=Math.PI/4,p=e.canvas.clientWidth/e.canvas.clientHeight,k=.1,f=100,v=Qe();At(v,l,p,k,f);const a=Qe(),x=O();nt(x,T.position,T.facing),Et(a,T.position,x,T.cameraUp);{const h=e.FLOAT,u=!1,b=0,y=0;e.bindBuffer(e.ARRAY_BUFFER,n.blocks.vertexPosition),e.vertexAttribPointer(o.blocks.attribLocations.vertexPosition,3,h,u,b,y),e.enableVertexAttribArray(o.blocks.attribLocations.vertexPosition)}const m=Math.floor(-T.position[1]);U("playerLayer",m);const g=50,P=Math.min(Math.max(0,m-g),V-1);U("layerStart",P);const _=Math.max(0,Math.min(V-1,m+g));U("layerEnd",_),e.bindBuffer(e.ARRAY_BUFFER,n.blocks.textureCoord),e.vertexAttribPointer(o.blocks.attribLocations.textureCoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o.blocks.attribLocations.textureCoord),e.bindBuffer(e.ARRAY_BUFFER,T.blocks.buffer),e.vertexAttribIPointer(o.blocks.attribLocations.block,1,e.UNSIGNED_INT,0,P*4*We),e.vertexAttribDivisor(o.blocks.attribLocations.block,1),e.enableVertexAttribArray(o.blocks.attribLocations.block),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.blocks.indices),e.useProgram(o.blocks.program),e.uniformMatrix4fv(o.blocks.uniformLocations.projectionMatrix,!1,v),e.uniformMatrix4fv(o.blocks.uniformLocations.modelViewMatrix,!1,a),e.uniform1i(o.blocks.uniformLocations.layerStart,P),e.uniform3fv(o.blocks.uniformLocations.highlighted,(B=T.highlighted)!=null?B:[0,0,0]),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.uniform1i(o.blocks.uniformLocations.sampler,0);{const u=e.UNSIGNED_SHORT,b=We*(_-P);e.drawElementsInstanced(e.TRIANGLES,36,u,0,b)}}window.onload=ko;
